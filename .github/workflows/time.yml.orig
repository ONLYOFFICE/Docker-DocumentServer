name : Tests

on:
  push:
  schedule:
    - cron: '0 21 * * 6'


  #push:
    #tags:
      #- "v[0-9]+.[0-9]+.[0-9]+"
  #pull_request:
    #tags:
      #- "v[0-9]+.[0-9]+.[0-9]+"


jobs:
  build:
    name: " Start test files:${{matrix.compose-files}} "
    runs-on: ubuntu-latest
    strategy:
      matrix:
        compose-files: [postgres.yml, mariadb.yml, graphite.yml, mysql.yml, rabbitmq.yml, standalone.yml, certs-customized.yml, postgres-old.yml, rabbitmq-old.yml, redis.yml]
        include:
          - compose-files: postgres.yml
            POSTGRES_VERSION: 9
          - compose-files: postgres.yml

#Comment strings
#|
#|
#graphite.yml, mysql.yml, postgres.yml, rabbitmq.yml, standalone.yml, certs-customized.yml,
#mariadb.yml, postgres-old.yml, rabbitmq-old.yml, redis.yml, mariadb.yml, postgres.yml

    steps:
      - name: Checkout
        uses: actions/checkout@v3

      - name: "Test files"
        run: |
          cd tests
          export config=${{ matrix.compose-files }}
          chmod +x test.sh
          bash test.sh
