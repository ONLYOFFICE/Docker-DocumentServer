language: generic

dist: trusty

env:
  # community edition
  - config: standalone.yml

  # integration edition
  - config: standalone.yml
    PRODUCT_NAME: documentserver-ie

  # certificates (default tls if onlyoffice not exists)
  - config: certs.yml
    ssl: true

  # certificates (default onlyoffice if exists)
  - config: certs.yml
    ssl: true
    private_key: onlyoffice.key
    certificate_request: onlyoffice.csr
    certificate: onlyoffice.crt

  # custom certificates
  - config: certs-customized.yml
    ssl: true
    private_key: mycert.key
    certificate_request: mycert.csr
    certificate: mycert.crt
    SSL_CERTIFICATE_PATH: /var/www/onlyoffice/Data/certs/mycert.crt
    SSL_KEY_PATH: /var/www/onlyoffice/Data/certs/mycert.key


  # postgresql 9.5
  - config: postgres.yml

  # custom values
  - config: postgres.yml
    DB_NAME: mydb
    DB_USER: myuser
    DB_PWD: password
    POSTGRES_DB: mydb
    POSTGRES_USER: myuser

  # postgresql 9
  - config: postgres.yml
    POSTGRES_VERSION: 

  # postgresql latest
  - config: postgres.yml
    POSTGRES_VERSION: latest

  # deprecated variables
  - config: postgres-old.yml


  # mysql 5.7
  - config: mysql.yml

  # mysql 5
  - config: mysql.yml
    MYSQL_VERSION: 5

  # mysql latest
  - config: mysql.yml
    MYSQL_VERSION: latest


  # mariadb 10.5
  - config: mariadb.yml

  # mariadb latest
  - config: mariadb.yml
    MARIADB_VERSION: latest


  # activemq 5.14.3
  - config: activemq.yml

  # activemq latest
  - config: activemq.yml
    ACTIVEMQ_VERSION: latest


  # rabbitmq latest
  - config: rabbitmq.yml

  # rabbitmq 3
  - config: rabbitmq.yml
    RABBITMQ_VERSION: 3

  # rabbitmq old variables
  - config: rabbitmq-old.yml


  # redis latest with community edition
  - config: redis.yml

  # redis latest with integraion edition
  - config: redis.yml
    PRODUCT_NAME: documentserver-ie

  # redis 5 with community edition
  - config: redis.yml
    REDIS_VERSION: 5


  # graphite
  - config: graphite.yml

services:
  - docker

script:
  # Go to tests dir
  - cd ${PWD}/tests

  # Run test.
  - ./test.sh
